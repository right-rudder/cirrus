---
import FormField from "./FormField.astro";
import type { Field, FormData } from "../utils/types";

interface Props {
  content: FormData
}

const { content } = Astro.props;
---

<form
  id={content.id || "form"}
  class="mt-8 space-y-6 scroll-mt-80"
  method={content.method || "post"}
  action={content.action || "#"}
>
  {/* HoneyPot */}
  <p class="hidden">
    <label>Don't fill this out if you're human: <input name="confirm_email" /></label>
  </p>

  {/* Dynamic fields */}
  <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
    {content.fields.map((f: Field) => <FormField f={f} />)}

    <div id={`${content.id}-error-message`} class="max-h-0 overflow-hidden border-l-4 rounded-sm border-yellow-400 bg-yellow-50 transition-all duration-500 ease-in-out col-span-full">
      <div class="flex m-4">
        <div class="shrink-0">
          <svg viewBox="0 0 20 20" fill="currentColor" data-slot="icon" aria-hidden="true" class="size-5 text-yellow-400">
            <path d="M8.485 2.495c.673-1.167 2.357-1.167 3.03 0l6.28 10.875c.673 1.167-.17 2.625-1.516 2.625H3.72c-1.347 0-2.189-1.458-1.515-2.625L8.485 2.495ZM10 5a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 10 5Zm0 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z" clip-rule="evenodd" fill-rule="evenodd" />
          </svg>
        </div>
        <div class="ml-3">
          <p class="text-sm text-yellow-700 whitespace-pre-line"></p>
        </div>
      </div>
    </div>
  </div>

  <div class="space-y-4 pt-2">
    {/* Terms */}
    <div class="flex items-start">
      <input
        id={`${content.id}-agree_to_terms_and_conditions`}
        name="agree_to_terms_and_conditions"
        type="checkbox"
        class="bg-muted-900/70 mt-1 h-5 w-5 rounded border-white/20 text-rose-500"
        required
      />
      <label for={`${content.id}-agree_to_terms_and_conditions`} class="text-muted-200 font-light ml-3 text-sm">
        I agree to the
        <a
          href="/privacy-policy"
          target="_blank"
          rel="noopener"
          class="underline transition-colors duration-300 ease-in-out hover:text-rose-500">Privacy Policy</a
        > and <a
          href="/terms-of-service"
          target="_blank"
          rel="noopener"
          class="underline transition-colors duration-300 ease-in-out hover:text-rose-500">Terms of Service</a
        > provided by the company. By providing my phone number, I agree to receive text messages from the business.
      </label>
    </div>

    <button id={`${content.id}-submitBtn`} type="submit" class="btn-rose" disabled>
      {content.submitBtnText || "Submit"}
    </button>
  </div>
</form>
